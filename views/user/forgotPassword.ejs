<% layout('/layouts/boilerplate') %>
<%- include('../partials/search') %>
<h1>Reset Your Password</h1>

<form action="/user/forgot-password/<%=userId%>/<%=code%>" id="resetForm" method="post" class="auth-form">
    <input 
        type="password"
        name="new_password"
        placeholder="New Password"
        id="new_password"
        required
        pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d@$!%*?&]{8,30}"
        title="8â€“30 characters, at least one uppercase, one lowercase, and one number"
    />
    <input type="password" name="new_password_repeat" placeholder="Repeat New Password" id="new_password_repeat" required>
    <p>Must meet the criteria: 8-30 characters, at least one uppercase letter, one lowercase letter and one number</p>
    <button class="btn btn-primary">Reset Password</button>
</form>

<p>
    Please write the new password down somewhere as there is a limit as to how many times you can reset.
</p>

<script>
    // Ensure passwords match
    document.getElementById('resetForm').addEventListener('submit', function (e) {
        const pass = document.getElementById('new_password').value;
        const repeat = document.getElementById('new_password_repeat').value;
        if (pass !== repeat) {
            e.preventDefault();
            alert('Passwords do not match.');
        }
    });
</script>